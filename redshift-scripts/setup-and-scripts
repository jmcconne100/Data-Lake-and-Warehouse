CREATE EXTERNAL SCHEMA lakehouse_glue_schema
FROM data catalog
DATABASE 'lakehouse_glue_db'
IAM_ROLE 'arn:aws:iam::<your-account-id>:role/RedshiftSuperAccessRole'
REGION 'us-west-1';

SELECT schemaname, tablename
FROM svv_external_tables
WHERE schemaname = 'lakehouse_glue_schema';

-- Preview the first 10 customers
SELECT * FROM lakehouse_glue_schema.customers LIMIT 10;

-- Top 5 products by total revenue
SELECT product_id, SUM(CAST(total_price AS DOUBLE PRECISION)) AS total_revenue
FROM lakehouse_glue_schema.orders
GROUP BY product_id
ORDER BY total_revenue DESC
LIMIT 5;
